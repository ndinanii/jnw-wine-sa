import{j as s}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.DiEladB3.js";import{u as f}from"./useCart.B1wYzpCN.js";const y="https://images.unsplash.com/photo-1516594798947-e65505dbb29d?auto=format&fit=crop&w=900&q=80";function b({product:t,onAddToCart:r,index:i=0}){const[l,n]=c.useState(!1),d=t.images?.edges?.[0]?.node?.url,e=t.variants?.edges?.[0]?.node,a=e?.price?.amount??e?.priceV2?.amount,o=a?parseFloat(a):0,m=o?`R${o.toFixed(2)}`:"",h=o?`R${(o*1.22).toFixed(2)}`:"";function p(){e?.availableForSale&&(r(e,t),n(!0),setTimeout(()=>n(!1),1200))}return s.jsxs("article",{className:"product-card",style:{animationDelay:`${i*60}ms`},children:[s.jsx("a",{href:`/product/${t.handle}`,style:{display:"block"},children:s.jsx("div",{className:"card-image",style:{aspectRatio:"1/1",position:"relative"},children:s.jsx("img",{src:d||y,alt:t.title,style:{width:"70%",height:"84%",objectFit:"contain",margin:"0 auto"},loading:"lazy"})})}),s.jsxs("div",{className:"product-card-body",children:[s.jsx("p",{className:"product-meta-label",children:"Estate Label"}),s.jsx("a",{href:`/product/${t.handle}`,children:s.jsx("h3",{className:"product-meta-title",children:t.title})}),s.jsx("p",{className:"product-meta-price",children:m?`Members: ${m}${h?` | ${h}`:""}`:"-"}),e?.availableForSale?s.jsx("button",{type:"button",className:"btn-gold",onClick:p,style:{width:"100%",padding:"8px 12px",fontSize:"0.58rem"},children:l?"Added":"Add to cart"}):s.jsx("span",{className:"btn-outline",style:{width:"100%",justifyContent:"center",padding:"8px 12px",fontSize:"0.58rem",opacity:.6,cursor:"not-allowed"},children:"Sold out"})]})]})}const u=[{key:"best-sellers",label:"Best Sellers"},{key:"whites",label:"Whites"},{key:"reds",label:"Reds"},{key:"rose",label:"Rose"},{key:"sparkling",label:"Sparkling"}];function g(t){if(!t)return"best-sellers";const r=String(t).toLowerCase();return u.some(i=>i.key===r)?r:"best-sellers"}function x(t){const r=[t?.title,t?.handle,t?.productType,...Array.isArray(t?.tags)?t.tags:[]].filter(Boolean).join(" ").toLowerCase();return/(sparkling|champagne|cap classique|prosecco|cava)/.test(r)?"sparkling":/(rose|ros[eÃ©])/.test(r)?"rose":/(white|sauvignon|chenin|chardonnay|semillon|viognier)/.test(r)?"whites":/(red|merlot|cabernet|shiraz|pinot noir|malbec|syrah)/.test(r)?"reds":"best-sellers"}function C({products:t=[]}){const{addToCart:r}=f(),[i,l]=c.useState("best-sellers");c.useEffect(()=>{function e(){const a=new URLSearchParams(window.location.search);l(g(a.get("category")))}return e(),window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)},[]);const n=c.useMemo(()=>i==="best-sellers"?t:t.filter(e=>x(e)===i),[t,i]);function d(e){if(l(e),typeof window>"u")return;const a=new URL(window.location.href);e==="best-sellers"?a.searchParams.delete("category"):a.searchParams.set("category",e),a.hash!=="#collection"&&(a.hash="collection"),window.history.replaceState({},"",a.toString())}return s.jsxs("section",{className:"catalog-layout",children:[s.jsx("div",{className:"catalog-tabs",role:"tablist","aria-label":"Collections",children:u.map(e=>s.jsx("button",{type:"button",className:i===e.key?"catalog-tab catalog-tab-active":"catalog-tab",onClick:()=>d(e.key),children:e.label},e.key))}),s.jsx("div",{className:"product-grid",children:n.length?n.map((e,a)=>s.jsx(b,{product:e,onAddToCart:r,index:a},e.id)):s.jsx("div",{className:"status-card category-empty",children:s.jsx("p",{children:"No products in this category yet."})})})]})}export{C as default};
