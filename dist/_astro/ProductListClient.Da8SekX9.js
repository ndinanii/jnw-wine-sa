import{j as a}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.DiEladB3.js";import{u as h}from"./useCart.B_6J7LxX.js";const u="https://images.unsplash.com/photo-1516594798947-e65505dbb29d?auto=format&fit=crop&w=900&q=80",p=155;function f({product:t,onAddToCart:s,index:l=0}){const[o,n]=i.useState(!1),c=t.images?.edges?.[0]?.node?.url,e=t.variants?.edges?.[0]?.node,r=`R${p.toFixed(2)} per bottle`;function m(){e?.availableForSale&&(s(e,t),n(!0),setTimeout(()=>n(!1),1200))}return a.jsxs("article",{className:"product-card",style:{animationDelay:`${l*60}ms`},children:[a.jsx("a",{href:`/product/${t.handle}`,style:{display:"block"},children:a.jsx("div",{className:"card-image",style:{aspectRatio:"1/1",position:"relative"},children:a.jsx("img",{src:c||u,alt:t.title,style:{width:"70%",height:"84%",objectFit:"contain",margin:"0 auto"},loading:"lazy"})})}),a.jsxs("div",{className:"product-card-body",children:[a.jsx("p",{className:"product-meta-label",children:"Estate Label"}),a.jsx("a",{href:`/product/${t.handle}`,children:a.jsx("h3",{className:"product-meta-title",children:t.title})}),a.jsx("p",{className:"product-meta-price",children:r}),e?.availableForSale?a.jsx("button",{type:"button",className:"btn-gold product-card-cta",onClick:m,style:{padding:"8px 12px",fontSize:"0.58rem"},children:o?"Added":"Add to cart"}):a.jsx("span",{className:"btn-outline product-card-cta",style:{justifyContent:"center",padding:"8px 12px",fontSize:"0.58rem",opacity:.6,cursor:"not-allowed"},children:"Sold out"})]})]})}const d=[{key:"best-sellers",label:"Best Sellers"},{key:"whites",label:"Whites"},{key:"reds",label:"Reds"},{key:"rose",label:"Rose"},{key:"sparkling",label:"Sparkling"}];function y(t){if(!t)return"best-sellers";const s=String(t).toLowerCase();return d.some(l=>l.key===s)?s:"best-sellers"}function b(t){const s=[t?.title,t?.handle,t?.productType,...Array.isArray(t?.tags)?t.tags:[]].filter(Boolean).join(" ").toLowerCase();return/(sparkling|champagne|cap classique|prosecco|cava)/.test(s)?"sparkling":/(rose|ros[eÃ©])/.test(s)?"rose":/(white|sauvignon|chenin|chardonnay|semillon|viognier)/.test(s)?"whites":/(red|merlot|cabernet|shiraz|pinot noir|malbec|syrah)/.test(s)?"reds":"best-sellers"}function w({products:t=[]}){const{addToCart:s}=h(),[l,o]=i.useState("best-sellers");i.useEffect(()=>{function e(){const r=new URLSearchParams(window.location.search);o(y(r.get("category")))}return e(),window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)},[]);const n=i.useMemo(()=>l==="best-sellers"?t:t.filter(e=>b(e)===l),[t,l]);function c(e){if(o(e),typeof window>"u")return;const r=new URL(window.location.href);e==="best-sellers"?r.searchParams.delete("category"):r.searchParams.set("category",e),r.hash!=="#collection"&&(r.hash="collection"),window.history.replaceState({},"",r.toString())}return a.jsxs("section",{className:"catalog-layout",children:[a.jsx("div",{className:"catalog-tabs",role:"tablist","aria-label":"Collections",children:d.map(e=>a.jsx("button",{type:"button",className:l===e.key?"catalog-tab catalog-tab-active":"catalog-tab",onClick:()=>c(e.key),children:e.label},e.key))}),a.jsx("div",{className:"product-grid",children:n.length?n.map((e,r)=>a.jsx(f,{product:e,onAddToCart:s,index:r},e.id)):a.jsx("div",{className:"status-card category-empty",children:a.jsx("p",{children:"No products in this category yet."})})})]})}export{w as default};
