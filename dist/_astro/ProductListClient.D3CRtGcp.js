import{j as a}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.DiEladB3.js";import{p as u,a as p,u as f}from"./useCart.KY0El3nN.js";const g="https://images.unsplash.com/photo-1516594798947-e65505dbb29d?auto=format&fit=crop&w=900&q=80",y=155;function b({product:e,onAddToCart:r,index:l=0}){const[i,n]=o.useState(!1),c=e.images?.edges?.[0]?.node?.url,t=u(e),s=p(e),m=`R${y.toFixed(2)} per bottle`;function h(){t?.availableForSale&&(r(t,e),n(!0),setTimeout(()=>n(!1),1200))}return a.jsxs("article",{className:"product-card",style:{animationDelay:`${l*60}ms`},children:[a.jsx("a",{href:`/product/${e.handle}`,style:{display:"block"},children:a.jsx("div",{className:"card-image",style:{aspectRatio:"1/1",position:"relative"},children:a.jsx("img",{src:c||g,alt:e.title,style:{width:"70%",height:"84%",objectFit:"contain",margin:"0 auto"},loading:"lazy"})})}),a.jsxs("div",{className:"product-card-body",children:[a.jsx("p",{className:"product-meta-label",children:"Estate Label"}),a.jsx("a",{href:`/product/${e.handle}`,children:a.jsx("h3",{className:"product-meta-title",children:e.title})}),s&&a.jsx("p",{className:"product-meta-vintage",children:s}),a.jsx("p",{className:"product-meta-price",children:m}),t?.availableForSale?a.jsx("button",{type:"button",className:"btn-gold product-card-cta",onClick:h,style:{padding:"8px 12px",fontSize:"0.64rem"},children:i?"Added":"Add to cart"}):a.jsx("span",{className:"btn-outline product-card-cta",style:{justifyContent:"center",padding:"8px 12px",fontSize:"0.64rem",opacity:.6,cursor:"not-allowed"},children:"Sold out"})]})]})}const d=[{key:"best-sellers",label:"Best Sellers"},{key:"whites",label:"Whites"},{key:"reds",label:"Reds"},{key:"rose",label:"Rose"},{key:"sparkling",label:"Sparkling"}];function x(e){if(!e)return"best-sellers";const r=String(e).toLowerCase();return d.some(l=>l.key===r)?r:"best-sellers"}function j(e){const r=[e?.title,e?.handle,e?.productType,...Array.isArray(e?.tags)?e.tags:[]].filter(Boolean).join(" ").toLowerCase();return/(sparkling|champagne|cap classique|prosecco|cava)/.test(r)?"sparkling":/(rose|ros[eÃ©])/.test(r)?"rose":/(white|sauvignon|chenin|chardonnay|semillon|viognier)/.test(r)?"whites":/(red|merlot|cabernet|shiraz|pinot noir|malbec|syrah)/.test(r)?"reds":"best-sellers"}function k({products:e=[]}){const{addToCart:r}=f(),[l,i]=o.useState("best-sellers");o.useEffect(()=>{function t(){const s=new URLSearchParams(window.location.search);i(x(s.get("category")))}return t(),window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)},[]);const n=o.useMemo(()=>l==="best-sellers"?e:e.filter(t=>j(t)===l),[e,l]);function c(t){if(i(t),typeof window>"u")return;const s=new URL(window.location.href);t==="best-sellers"?s.searchParams.delete("category"):s.searchParams.set("category",t),s.hash!=="#collection"&&(s.hash="collection"),window.history.replaceState({},"",s.toString())}return a.jsxs("section",{className:"catalog-layout",children:[a.jsx("div",{className:"catalog-tabs",role:"tablist","aria-label":"Collections",children:d.map(t=>a.jsx("button",{type:"button",className:l===t.key?"catalog-tab catalog-tab-active":"catalog-tab",onClick:()=>c(t.key),children:t.label},t.key))}),a.jsx("div",{className:"product-grid",children:n.length?n.map((t,s)=>a.jsx(b,{product:t,onAddToCart:r,index:s},t.id)):a.jsx("div",{className:"status-card category-empty",children:a.jsx("p",{children:"No products in this category yet."})})})]})}export{k as default};
