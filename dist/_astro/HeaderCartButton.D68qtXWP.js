import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.DiEladB3.js";import{u as x}from"./useCart.B_6J7LxX.js";function y({cart:s,onIncrement:n,onDecrement:c,onCheckout:m,checkoutState:o,sticky:p=!0}){const r=i.useMemo(()=>s.reduce((t,d)=>t+d.qty,0),[s]),l=i.useMemo(()=>s.reduce((t,d)=>t+parseFloat(d.price||0)*d.qty,0),[s]),a=`${p?"cart-sidebar ":""}glass-strong`.trim();return e.jsxs("aside",{className:a,style:{padding:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[e.jsx("h2",{style:{margin:0,fontSize:"1.3rem"},children:"Cart"}),e.jsxs("span",{className:"badge",children:[r," ",r===1?"item":"items"]})]}),e.jsx("hr",{className:"gold-divider",style:{margin:"12px 0"}}),s.length===0?e.jsx("p",{style:{margin:0,fontFamily:"Inter, sans-serif",fontSize:"0.85rem",color:"var(--color-text-muted)"},children:"Your cart is empty"}):e.jsx("ul",{style:{listStyle:"none",margin:0,padding:0,display:"grid",gap:"8px"},children:s.map(t=>e.jsxs("li",{style:{borderRadius:"var(--radius-sm)",border:"1px solid rgba(197,164,90,0.12)",padding:"12px",background:"rgba(197,164,90,0.03)"},children:[e.jsx("p",{style:{margin:"0 0 2px",fontFamily:"Inter, sans-serif",fontSize:"0.82rem"},children:t.title}),e.jsxs("p",{style:{margin:"0 0 10px",fontFamily:"Inter, sans-serif",fontSize:"0.72rem",color:"var(--color-text-muted)"},children:[t.variantTitle,t.price?` - R${parseFloat(t.price).toFixed(2)} per bottle`:""]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("button",{type:"button",className:"qty-btn",onClick:()=>c(t.variantId),children:"-"}),e.jsx("span",{style:{minWidth:"20px",textAlign:"center",fontFamily:"Inter, sans-serif",fontSize:"0.82rem"},children:t.qty}),e.jsx("button",{type:"button",className:"qty-btn",onClick:()=>n(t.variantId),children:"+"})]})]},t.variantId))}),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"gold-divider",style:{margin:"12px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"},children:[e.jsx("span",{style:{fontFamily:"Inter, sans-serif",fontSize:"0.75rem",color:"var(--color-text-muted)"},children:"Estimated total"}),e.jsxs("strong",{style:{color:"var(--color-gold-soft)"},children:["R",l.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsx("button",{type:"button",disabled:!s.length||o==="loading",onClick:m,className:"btn-gold",style:{width:"100%",padding:"10px",opacity:s.length?1:.45},children:o==="loading"?"Redirecting...":"Checkout"})]})}function f(){const{cart:s,totalItems:n,checkoutState:c,increment:m,decrement:o,checkout:p}=x(),[r,l]=i.useState(!1);return i.useEffect(()=>{const a=document.body.style.overflow;return r?document.body.style.overflow="hidden":document.body.style.overflow=a||"",()=>{document.body.style.overflow=a||""}},[r]),i.useEffect(()=>{function a(t){t.key==="Escape"&&l(!1)}return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]),e.jsxs("div",{className:"header-cart-wrap",children:[e.jsxs("button",{type:"button",className:"icon-link cart-trigger","aria-label":`Cart (${n} items)`,onClick:()=>l(!0),children:[e.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[e.jsx("path",{d:"M5 7h14l-1.4 8.2a2 2 0 0 1-2 1.7H8.4a2 2 0 0 1-2-1.7L5 7Z"}),e.jsx("path",{d:"M9 7V5a3 3 0 0 1 6 0v2"})]}),n>0&&e.jsx("span",{className:"header-cart-badge",children:n>99?"99+":n})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"header-cart-overlay","aria-label":"Close cart",onClick:()=>l(!1)}),e.jsxs("aside",{className:"header-cart-panel","aria-label":"Shopping cart panel",children:[e.jsxs("div",{className:"header-cart-panel-head",children:[e.jsx("p",{children:"Cart"}),e.jsx("button",{type:"button",className:"header-cart-close","aria-label":"Close cart",onClick:()=>l(!1),children:"x"})]}),e.jsx("div",{className:"header-cart-panel-body",children:e.jsx(y,{cart:s,onIncrement:m,onDecrement:o,onCheckout:p,checkoutState:c,sticky:!1})})]})]})]})}export{f as default};
